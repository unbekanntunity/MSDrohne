# ********************* Threading ***********************
import _thread
import time

from drohne.event_handling import EventHandler

class DisposableLoopThread(object):
    def __init__(self):
        self.events = EventHandler()
        self.on_finished_events = EventHandler()

        self.proceed = False
        self.interval_sec = 1

    def start(self):
        if not self.proceed:
            self.proceed = True
            _thread.start_new_thread(self.run, ())

    def run(self):
        while self.proceed:
            time.sleep(self.interval_sec)
            self.events.invoke()

    def add_event(self, function):
        self.events.add_event(function)

    def stop(self):
        self.proceed = False
        self.on_finished_events.invoke()
